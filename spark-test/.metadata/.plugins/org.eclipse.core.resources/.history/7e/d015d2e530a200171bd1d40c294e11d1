package KPI

import org.apache.spark._
import org.apache.spark.SparkContext._
import org.apache.log4j._
import java.util.ArrayList
import org.apache.spark.rdd.RDD

object NivelIngresos {
  
  def NivelIngresos(ruta: String) = {
    val sc = new SparkContext("local[*]", "NivelIngresos")
    val rdd = sc.textFile(ruta)
    val r1 = rdd.map(r => r.split("\t")).map(r => (r(6), r(46)))
    
    //Tenemos dos alternativas
    r1.map(x => (x._1 + "," + x._2, 1)).reduceByKey(_ + _).foreach(println)
    //r1.sortByKey().countByValue.foreach(println)
  }

  def main(args: Array[String]) {

    NivelIngresos("tablon.tsv")


  }
  
}